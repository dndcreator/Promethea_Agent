# 配置文件夹说明

本目录用于存储系统的所有配置文件。

## 目录结构

```
config/
├── default.json          # 默认配置文件（系统级配置）
├── users/                # 用户配置目录
│   ├── {user_id}.json   # 每个用户的个性化配置文件
│   └── .gitkeep         # 保持目录存在
└── README.md            # 本文件
```

## 配置文件说明

### 1. `default.json` - 默认配置

- **位置**: `config/default.json`
- **用途**: 系统级的默认配置，包含所有非敏感配置项
- **优先级**: 最低（环境变量 > 用户配置 > 默认配置）
- **特点**:
  - 用户可以随时选择回到默认配置
  - 如果读取配置出错，会自动回退到默认配置
  - 不应包含敏感信息（如 API Key、密码等）

### 2. `users/{user_id}.json` - 用户配置

- **位置**: `config/users/{user_id}.json`
- **用途**: 每个用户的个性化配置
- **优先级**: 中等（环境变量 > 用户配置 > 默认配置）
- **特点**:
  - 每个用户有独立的配置文件
  - 可以覆盖默认配置中的任意字段
  - 支持用户级别的模型切换、提示词定制等

### 3. 环境变量配置

- **位置**: `.env` 文件（项目根目录）
- **用途**: 存储敏感信息（API Key、密码等）
- **优先级**: 最高（环境变量 > 用户配置 > 默认配置）
- **特点**:
  - 不应提交到版本控制系统
  - 使用 `env.example` 作为模板

## 配置加载顺序

1. **环境变量** (`.env` 或系统环境变量) - 最高优先级
2. **用户配置** (`config/users/{user_id}.json`) - 中等优先级
3. **默认配置** (`config/default.json`) - 最低优先级

## 配置回退机制

- 如果用户配置读取失败，自动回退到默认配置
- 如果默认配置读取失败，使用代码中的硬编码默认值
- 如果配置验证失败，自动回退到默认配置

## 迁移说明

- 旧的 `config.json` 文件会自动迁移到 `config/default.json`
- 旧的 `users/{user_id}/config.json` 文件会自动迁移到 `config/users/{user_id}.json`
- 系统支持向后兼容，旧的路径仍然可以工作
